<%= render 'principal/header' %>

      <!-- CONTENT CONTAINER -->
      <div class="container page-section pt-140-b-80-cont pl-50-min-1169 pr-50-min-1169">
        <div class="row">
          <!-- SIDENAV HIDE -->
          <%= render 'principal/sidebar' %>
          <!-- INTRODUCCIÓN  -->
          <div class="col-lg-9 col-md-8 col-sm-12 plr-50">
            <h2 class="section-title pr-0 mb-20"><span class="bold "><%= @tema.upcase %></span></h2>
            <div class="row">
              <div class="col-md-10 col-sm-12 col-md-offset-1">
                <p class="text-left"><%= "Aquí podrás encontrar información de estudios sobre América Latina relacionada con el tema de " + @tema + "." %></p>
              </div>
            </div>
            <!-- FORMULARIO DE BÚSQUEDA -->
<script>
function filter(f_ids){
	var where = "", multi = false, val;
	for(var i=0;i<f_ids.length;i++){
		val = $("#"+f_ids[i]).val();
		where = where + (val != "" ? "&conds["+f_ids[i]+"]="+ val : "");
	}
	$.ajax({
		url: "/historia.js?offset=0&conds[tema]=Historia" + where,
		success: function(){}
	});
}

function clean(){
	$("#sect").value(null);
	$("#key").value("");
	$.ajax({
		url: "/historia.js?offset=0&conds[tema]=Historia",
		success: function(result){}
	});
}
</script>
            <div class="row">
              <div class="col-md-12 mt-40 plr-xs-0 plr-50 ">
                <!-- FORMULARIO DE BÚSQUEDA -->
                <div class="row">
                  <div class="col-md-5 col-sm-6">
                    <div class="row">
                      <div class="col-md-4 col-sm-12 plr-0">
                        <h4 class="mt-10"><strong>Buscar por: </strong></h4>
                      </div>
                      <div class="col-md-8 pl-0">
                        <input oninput="filter(['key','sect']);" id="key" placeholder="Palabra(s) clave" class="input-border w-100" type="text" required="">
                      </div>
                    </div>
                  </div>
                  <div class="col-md-4 col-sm-6">
                    <div class="row">
                      <div class="col-md-4 col-sm-12 plr-0">
                        <h4 class="mt-10"><strong>Filtrar por: </strong></h4>
                      </div>
                      <div class="col-md-8 pl-0">
                          <select onchange="filter(['key','sect']);" name="sect" id="sect" class="select-md input-border w-100">
                            <option value>Tipo</option>
                            <option value="pub">Publicaciones</option>
                            <option value="rev">Revistas</option>
                            <option value="tesis">Tesis</option>
                            <option value="vid">Videos</option>
                          </select>
                      </div>
                    </div>
                  </div>
                  <div class="col-md-3 col-sm-6 plr-0">
                    <br class="visible-sm visible-xs">
                    <button onclick="clean();" class="button medium hover-thin deeporange w-100-767">LIMPIAR BÚSQUEDA</button>
                  </div>
                </div>
                <!-- FIN FORMULARIO DE BÚSQUEDA -->
                <div class="row mt-30 mb-40">
                  <div class="col-md-8 col-xs-12 text-left">
                    <h3 class="verde-obscuro m-0"><strong>Se muestran los resultados de las búquedas</strong></h3>
                  </div>
                  <div class="col-md-4 hidden-sm hidden-xs text-right">
                    <h3 id="count_p" class="verde-obscuro m-0"><strong>Total: 000</strong></h3>
                  </div>
                  <div class="hidden-lg hidden-md col-sm-12 col-xs-12 text-left">
                    <h3 id="count_pr" class="verde-obscuro"><strong>Total: 000</strong></h3>
                  </div>
                </div>
                <!-- TOGGLES  -->
                <div id="toggles" class="bs-docs-section mb-50">
                  <div class="row mb-30">
                    <div class="col-md-12">
                      <!-- Toggle -->
                      <dl id="toggle" class="toggle">
                        <dt>
                          <a href="#"><h5 class="m-0 text-left">Distorsiones regionales en la asignación de recursos y productividad de las manufacturas en México</h5><h5 class="verde-obscuro mt-10 mb-0">Pedro J. Martínez Alanis</h5></a>
                        </dt>
                        <dd>
                          <div class="row">
                            <div class="col-md-7">
                              <p class="text-left"><strong class="azul-obscuro">Revista:</strong> <span>Revista de Estudios Económicos</span></p>
                              <p class="text-left"><strong class="azul-obscuro">Volumen:</strong> <span>27</span></p>
                              <p class="text-left"><strong class="azul-obscuro">Número:</strong> <span>1 (53)</span></p>
                              <p class="text-left"><strong class="azul-obscuro">Enlace:</strong> <a href="http://estudioseconomicos.colmex.mx/archivo/EstudiosEconomicos2012/3-59.pdf" target="_blank" class="a-inv">http://estudioseconomicos.colmex.mx/archivo/EstudiosEconomicos2012/3-59.pdf</a></p>
                            </div>
                            <div class="col-md-5">
                              <p class="text-left"><strong class="azul-obscuro">Fecha de publicación:</strong> <span>enero-junio de 2012</span></p>
                              <p class="text-left"><strong class="azul-obscuro">Temática:</strong> <span>Cuestiones socio-económicas</span></p>
                            </div>
                          </div>
                        </dd>
                        <dt>
                          <a href="#"><h5 class="m-0 text-left">Distorsiones regionales en la asignación de recursos y productividad de las manufacturas en México</h5><h5 class="verde-obscuro mt-10 mb-0">Pedro J. Martínez Alanis</h5></a>
                        </dt>
                        <dd>
                          <div class="row">
                            <div class="col-md-7">
                              <p class="text-left"><strong class="azul-obscuro">Revista:</strong> <span>Revista de Estudios Económicos</span></p>
                              <p class="text-left"><strong class="azul-obscuro">Volumen:</strong> <span>27</span></p>
                              <p class="text-left"><strong class="azul-obscuro">Número:</strong> <span>1 (53)</span></p>
                              <p class="text-left"><strong class="azul-obscuro">Enlace:</strong> <a href="http://estudioseconomicos.colmex.mx/archivo/EstudiosEconomicos2012/3-59.pdf" target="_blank" class="a-inv">http://estudioseconomicos.colmex.mx/archivo/EstudiosEconomicos2012/3-59.pdf</a></p>
                            </div>
                            <div class="col-md-5">
                              <p class="text-left"><strong class="azul-obscuro">Fecha de publicación:</strong> <span>enero-junio de 2012</span></p>
                              <p class="text-left"><strong class="azul-obscuro">Temática:</strong> <span>Cuestiones socio-económicas</span></p>
                            </div>
                          </div>
                        </dd>
                        <dt>
                          <a href="#"><h5 class="m-0 text-left">Distorsiones regionales en la asignación de recursos y productividad de las manufacturas en México</h5><h5 class="verde-obscuro mt-10 mb-0">Pedro J. Martínez Alanis</h5></a>
                        </dt>
                        <dd>
                          <div class="row">
                            <div class="col-md-7">
                              <p class="text-left"><strong class="azul-obscuro">Revista:</strong> <span>Revista de Estudios Económicos</span></p>
                              <p class="text-left"><strong class="azul-obscuro">Volumen:</strong> <span>27</span></p>
                              <p class="text-left"><strong class="azul-obscuro">Número:</strong> <span>1 (53)</span></p>
                              <p class="text-left"><strong class="azul-obscuro">Enlace:</strong> <a href="http://estudioseconomicos.colmex.mx/archivo/EstudiosEconomicos2012/3-59.pdf" target="_blank" class="a-inv">http://estudioseconomicos.colmex.mx/archivo/EstudiosEconomicos2012/3-59.pdf</a></p>
                            </div>
                            <div class="col-md-5">
                              <p class="text-left"><strong class="azul-obscuro">Fecha de publicación:</strong> <span>enero-junio de 2012</span></p>
                              <p class="text-left"><strong class="azul-obscuro">Temática:</strong> <span>Cuestiones socio-económicas</span></p>
                            </div>
                          </div>
                        </dd>
                        <dt>
                          <a href="#"><h5 class="m-0 text-left">Distorsiones regionales en la asignación de recursos y productividad de las manufacturas en México</h5><h5 class="verde-obscuro mt-10 mb-0">Pedro J. Martínez Alanis</h5></a>
                        </dt>
                        <dd>
                          <div class="row">
                            <div class="col-md-7">
                              <p class="text-left"><strong class="azul-obscuro">Revista:</strong> <span>Revista de Estudios Económicos</span></p>
                              <p class="text-left"><strong class="azul-obscuro">Volumen:</strong> <span>27</span></p>
                              <p class="text-left"><strong class="azul-obscuro">Número:</strong> <span>1 (53)</span></p>
                              <p class="text-left"><strong class="azul-obscuro">Enlace:</strong> <a href="http://estudioseconomicos.colmex.mx/archivo/EstudiosEconomicos2012/3-59.pdf" target="_blank" class="a-inv">http://estudioseconomicos.colmex.mx/archivo/EstudiosEconomicos2012/3-59.pdf</a></p>
                            </div>
                            <div class="col-md-5">
                              <p class="text-left"><strong class="azul-obscuro">Fecha de publicación:</strong> <span>enero-junio de 2012</span></p>
                              <p class="text-left"><strong class="azul-obscuro">Temática:</strong> <span>Cuestiones socio-económicas</span></p>
                            </div>
                          </div>
                        </dd>
                      </dl>
                      <!-- End Toggle -->
                    </div>
                  </div>
                </div>
                <div class="row mb-30">
                  <div class="col-md-12 text-center">
                    <nav class="blog-pag">
                      <ul id="pags" class="pagination">

                      </ul>
                    </nav>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="col-md-3 visible-md"></div>
          <!-- FIN ROW -->
        </div>
        <!-- FIN CONTENT CONTAINER -->
      </div>
<script>
$.ajax({
	url: 'https://coed.colmex.mx/catalogo_videos.json?tags=Latinoamérica, <%= @tema %>',
	success: function(result){
		var limit = 10;
		var pubs = <%= raw @pubs.to_json %>;
		var revs = <%= raw @revs.to_json %>;
		var tesis = <%= raw @tesis.to_json %>;
		for(var i = 0; i < result["vids"].length; i++){
			result["vids"][i]["sect"] = "vid";
		}
		var todo = ("<%= @tipo %>" == "pub" ? pubs : ("<%= @tipo %>" == "rev" ? revs : ("<%= @tipo %>" == "tesis" ? tesis : ("<%= @tipo %>" == "vid" ? result["vids"] : pubs.concat(revs,tesis,result["vids"])))));
		var limit = 10;
		var offset = <%= params.key?(:offset) ? params[:offset].to_i : 0 %>;
		var html_toggle = "";
		for(var i = 0; i < limit; i++){
			if((limit*offset)+i >= todo.length) break;
			if(todo[i]["sect"] == "pub"){
                  html_toggle = html_toggle + '<dt>' +
                    '<a href="#"><h5 class="m-0 text-left">' + todo[i]["titulo"] + '</h5><h5 class="verde-obscuro mt-10 mb-0">' + todo[i]["autores"] + '</h5></a>' +
                  '</dt>' +
                  '<dd>' +
                    '<div class="row">' +
                      '<div class="col-md-7">' +
                        '<p class="text-left"><strong class="azul-obscuro">Lugar de publicación:</strong> <span>' + todo[i]["lugar"] + '</span></p>' +
                        '<p class="text-left"><strong class="azul-obscuro">Editorial:</strong> <span>' + todo[i]["editorial"] + '</span></p>' +
                        '<p class="text-left"><strong class="azul-obscuro">Tema:</strong> <span>' + todo[i]["tematica"] + '</span></p>' +
                        '<p class="text-left"><strong class="azul-obscuro">Enlace:</strong> <a href="' + todo[i]["link"] + '" target="_blank" class="a-inv">' + todo[i]["link"] + '</a></p>' +
                      '</div>' +
                      '<div class="col-md-5">' +
                        '<p class="text-left"><strong class="azul-obscuro">Centro de estudios:</strong> <span>' + todo[i]["centro"] + '</span></p>' +
                        '<p class="text-left"><strong class="azul-obscuro">Edición:</strong> <span>' + todo[i]["edicion"] + '</span></p>' +
                        '<p class="text-left"><strong class="azul-obscuro">Año:</strong> <span>' + todo[i]["anio"] + '</span></p>' +
                      '</div>' +
                    '</div>' +
                  '</dd>';
			} else if(todo[i]["sect"] == "rev"){
                  html_toggle = html_toggle + '<dt>' +
                    '<a href="#"><h5 class="m-0 text-left">' + todo[i]["articulo"] + '</h5><h5 class="verde-obscuro mt-10 mb-0">' + todo[i]["autores"] + '</h5></a>' +
                  '</dt>' +
                  '<dd>' +
                    '<div class="row">' +
                      '<div class="col-md-7">' +
                        '<p class="text-left"><strong class="azul-obscuro">Revista:</strong> <span>' + todo[i]["revista"] + '</span></p>' +
                        '<p class="text-left"><strong class="azul-obscuro">Volumen:</strong> <span>' + todo[i]["volumen"] + '</span></p>' +
                        '<p class="text-left"><strong class="azul-obscuro">Número:</strong> <span>' + todo[i]["numero"] + '</span></p>' +
                        '<p class="text-left"><strong class="azul-obscuro">Enlace:</strong> <a href="' + todo[i]["link"] + '" target="_blank" class="a-inv">' + todo[i]["link"] + '</a></p>' +
                      '</div>' +
                      '<div class="col-md-5">' +
                        '<p class="text-left"><strong class="azul-obscuro">Fecha de publicación:</strong> <span>' + todo[i]["fecha"] + '</span></p>' +
                        '<p class="text-left"><strong class="azul-obscuro">Temática:</strong> <span>' + todo[i]["tematica"] + '</span></p>' +
                      '</div>' +
                    '</div>' +
                  '</dd>';
			} else if(todo[i]["sect"] == "tesis"){
                        html_toggle = html_toggle + '<dt>' +
                    '<a href="#"><h5 class="m-0 text-left">' + todo[i]["titulo"] + '</h5><h5 class="verde-obscuro mt-10 mb-0">' + todo[i]["autores"] + '</h5></a>' +
                  '</dt>' +
                  '<dd>' +
                    '<div class="row">' +
                      '<div class="col-md-8">' +
                        '<p class="text-left"><strong class="azul-obscuro">Asesor (es):</strong> <span>' + todo[i]["asesores"] + '</span></p>' +
                        '<p class="text-left"><strong class="azul-obscuro">Programa Académico:</strong> <span>' + todo[i]["grado"] + ' en ' + todo[i]["programa"] + '</span></p>' +
                        '<p class="text-left"><strong class="azul-obscuro">Año:</strong> <span>' + todo[i]["anio"] + '</span></p>' +
                        '<p class="text-left"><strong class="azul-obscuro">Enlace:</strong> <a href="' + todo[i]["link"] + '" target="_blank" class="a-inv">' + todo[i]["link"] + '</a></p>' +
                      '</div>' +
                      '<div class="col-md-4">' +
                        '<p class="text-left"><strong class="azul-obscuro">Tema:</strong> <span>' + todo[i]["tematica"] + '</span></p>' +
                        '<p class="text-left"><strong class="azul-obscuro">Centro de Estudios:</strong> <span>' + todo[i]["centro"] + '</span></p>' +
                        '<p class="text-left"><strong class="azul-obscuro">Idioma:</strong> <span>' + todo[i]["idioma"] + '</span></p>' +
                      '</div>' +
                    '</div>' +
                  '</dd>';
			} else if(todo[i]["sect"] == "vid"){
				var fecha_vid = todo[i]["fecha"].substring(0,10).split("-");
				html_toggle = html_toggle + '<dt>' +
                              '<a href="#"><h5 class="m-0 text-left">' + todo[i]["titulo"] + '</h5>' + //'<h5 class="verde-obscuro mt-10 mb-0">Miguel Basáñez; José Romero; Gerardo Esquivel; Leonardo Curzio</h5></a>' +
                        '</dt>' +
                        '<dd>' +
                          '<div class="row">' +
                            '<div class="col-md-7">' +
                              '<p class="text-left"><strong class="azul-obscuro">Descripción:</strong> <span>' + todo[i]["descripcion"] + '</span></p>' +
                              '<p class="text-left"><strong class="azul-obscuro">Fecha de Publicación:</strong> <span>' + fecha_vid[2] + "-" + fecha_vid[1] + "-" + fecha_vid[0] + '</span></p>' +
                            '</div>' +
                            '<div class="col-md-5">' +
                              '<p class="text-left"><strong class="azul-obscuro">Tema:</strong> <span>' + find_tag(todo[i]["tags"]) + '</span></p>' +
                              '<p><a class="button medium  gray-light" href="https://www.youtube.com/watch?v=' + todo[i]["v_id"] + '" target="_blank">VER VIDEO <span class="icon icon-basic-video"></span></a></p>' +
                            '</div>' +
                          '</div>' +
                        '</dd>';
			}
		}
		$("#toggle").html(html_toggle);
		console.log(todo);


		var pags = Math.ceil(todo.length/limit);
		var pag_html = ""
		for(var i = 0; i < pags; i++){
			if(i == 0){
				                    pag_html = pag_html + '<li><a id="mag-ant" href="<%= historia_path(params: {offset: 0, conds: {tema: "Historia"}}) %>' + ($("#sect").val() != "" ? ("&conds[sect]=" + $("#sect").val()) : "") + ($("#key").val() != "" ? ("&conds[key]=" + $("#key").val()) : "") + '" data-remote="true"><i class="fa fa-angle-left"></i><span class="sr-only">Anterior</span></a></li>';
			}
				                    pag_html = pag_html + '<li data-i="' + i + '" id="mag-' + i +'" class="mag ' + (i ==  <%= params[:offset].to_i %> ? 'active' : '') + '"><a href="/historia?offset=' + i + "&conds[tema]=<%= @tema %>" + ($("#sect").val() != "" ? ("&conds[sect]=" + $("#sect").val()) : "") + ($("#key").val() != "" ? ("&conds[key]=" + $("#key").val()) : "") + '" data-remote="true">' + (i+1) + '</a></li>';
			if(i == pags - 1){
				                    pag_html = pag_html + '<li><a id="mag-nxt" href="<%= historia_path(params: {offset: 1, conds: {tema: "<%= @tema %>"}}) %>' + ($("#sect").val() != "" ? ("&conds[sect]=" + $("#sect").val()) : "") + ($("#key").val() != "" ? ("&conds[key]=" + $("#key").val()) : "") + '" data-remote="true"><i class="fa fa-angle-right"></i><span class="sr-only">Siguiente</span></a></li>';
			}
		}
		$("#pags").html(pag_html);
		$("#mag-ant").attr("href", "<%= historia_path(params: {offset: (params[:offset] == '0' ? 0 : (params[:offset].to_i - 1)), conds: {tema: 'Historia'}}) %>" + ($("#sect").val() != "" ? ("&conds[sect]=" + $("#sect").val()) : "") + ($("#key").val() != "" ? ("&conds[key]=" + $("#key").val()) : "") );
		$("#mag-nxt").attr("href", "<%= historia_path(params: {conds: {tema: '<%= @tema %>'}}) %>" + "&offset=" + (pags - 1 == parseInt(<%= params[:offset] %>) ? pags - 1 : parseInt(<%= params[:offset] %>) ) + ($("#sect").val() != "" ? ("&conds[sect]=" + $("#sect").val()) : "") + ($("#key").val() != "" ? ("&conds[key]=" + $("#key").val()) : "") );

		$("#count_p").html('<strong>Total: ' + todo.length + '</strong>');
		$("#count_pr").html('<strong>Total: ' + todo.length + '</strong>');

	  // TOGGLE
  $(".toggle > dd").hide();
  
  $(".toggle > dt > a").click(function(){
  
      if ($(this).hasClass("active")) {
      
          $(this).parent().next().slideUp("easeOutExpo");
          $(this).removeClass("active");
          
      }
      else {
          var current = $(this).parent().next("dd");
          $(this).addClass("active");
          $(this).parent().next().slideDown("easeOutExpo");
      }
      
      return false;
  });
		}
	});

function find_tag(tags){
	var temas = "";
	if(tags.indexOf("Violencia") != -1) temas = "Violencia y Derechos Humanos";
	if(tags.indexOf("Cuestiones socioeconómicas") != -1 || tags.indexOf("Sociedad y economía") != -1) temas = temas + (temas.length != 0 ?  "; " : "") + "Sociedad y economía";
	if(tags.indexOf("Relaciones internacionales") != -1) temas = temas + (temas.length != 0 ?  "; " : "") + "Relaciones internacionales";
	if(tags.indexOf("Instituciones políticas") != -1 || tags.indexOf("Política, partidos e instituciones") != -1) temas = temas + (temas.length != 0 ?  "; " : "") + "Política, partidos e instituciones";
	if(tags.indexOf("Historia") != -1) temas = temas + (temas.length != 0 ?  "; " : "") + "Historia";
	if(tags.indexOf("Lengua y Literatura") != -1) temas = temas + (temas.length != 0 ?  "; " : "") + "Lengua y Literatura";
	return temas;
}


</script>
<%= render 'principal/footer' %>
